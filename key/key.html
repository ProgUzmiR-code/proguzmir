<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
        .radius,
        .verification-input,
        .btn-submit,
        .btn {
            border-radius: 9px;
        }

        .youtubepaf {
            margin: 10px;
        }

        .fa-brands {
            font-size: 40px;
            color: red;
            background: white;
            border-radius: 10px;
            padding: 5px;
        }

        .shaffof {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            margin: 10px 0 0 0;
            color: white;
        }

        .key {
            width: 20px;
            height: 20px;
        }

        .dflex {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px;
        }

        .pop-dialog {
            display: flex;
            justify-content: center;
        }


        .pop-main {
            padding: 18px 18px 3px;
            background: #282735;
            border-radius: 18px;
            text-align: center;
        }

        .pop-main .energy__title {
            font-weight: 700;
            font-size: 18px;
            color: #fff;
            text-align: center;
            margin-bottom: 3px
        }

        .pop-main .invite-item {
            border-radius: .12rem;
            padding: .075rem .09rem;
            margin-bottom: .075rem;
            background: hsla(0, 0%, 100%, .15);
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center
        }

        .pop-main .invite-item.active .invite-arrow {
            color: #fff
        }

        .pop-main .invite-item .invite-icon {
            width: 20px;
            height: 20px;
            border-radius: .095rem;
            background: hsla(0, 0%, 100%, .15);
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            font-size: .17rem;
            color: #fff;
            display: flex;
            align-items: center;
            -webkit-box-pack: center;
            -webkit-justify-content: center;
            -ms-flex-pack: center;
            justify-content: center;
            overflow: hidden
        }

        .pop-main .invite-item .invite-icon img {
            margin: auto;
            width: 100%;
            height: 100%
        }

        .pop-main .invite-item .invite-info {
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            -ms-flex: 1;
            flex: 1;
            margin-left: 2px
        }

        .pop-main .invite-item .invite-info .invite__title {
            text-align: left;
            font-size: .115rem;
            font-weight: 300;
            color: hsla(0, 0%, 100%, .6)
        }

        .pop-main .invite-item .invite-info .invite__intro {
            font-size: .12rem;
            line-height: 1.2;
            margin-top: .04rem;
            position: relative;
            z-index: 1;
            padding-right: 18px;
            text-align: left;
            font-weight: 700;
            color: #fff
        }

        .pop-main .invite-item .invite-info .invite__intro span {
            color: hsla(0, 0%, 100%, .5);
            font-weight: 300;
            font-size: .12rem
        }

        .pop-main .invite-item .invite-info .invite__intro img {
            position: absolute;
            left: 0;
            top: 45%;
            -webkit-transform: translateY(-50%);
            -ms-transform: translateY(-50%);
            transform: translateY(-50%);
            width: .13rem;
            height: .13rem
        }

        .pop-main .invite-item .invite-info .invite__num {
            font-size: .13rem;
            margin-top: .04rem;
            position: relative;
            z-index: 1;
            font-weight: 300;
            text-align: left;
            font-weight: 700;
            color: #fff;
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
            -webkit-box-pack: left;
            -webkit-justify-content: left;
            -ms-flex-pack: left;
            justify-content: left
        }

        .pop-main .invite-item .invite-info .invite__num span {
            color: hsla(0, 0%, 100%, .5);
            font-weight: 300;
            font-size: .12rem
        }

        .pop-main .invite-item .invite-info .invite__num>img {
            width: 3px;
            height: 3px
        }

        .pop-main .invite-item .invite-info .invite__num .invite__keys {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
            height: 3px;
            line-height: 3px
        }

        .pop-main .invite-item .invite-info .invite__num .invite__keys img {
            width: 18px;
            height: 18px;
            margin-left: 2px;
            margin-right: .025rem
        }

        .pop-main .invite-item .invite-time {
            margin-left: .05rem
        }

        .pop-main .invite-item .invite-arrow {
            font-size: 18px;
            color: hsla(0, 0%, 100%, .25)
        }

        .pop-main .invite-item .invite-arrow .btn {
            font-size: 2px;
            color: #fff;
            background: #2464f6;
            border-radius: 18px;
            padding: 10px 6px;
        }

        .pop-main .invite-item .invite-arrow.refresh .scoped-svg-icon {
            -webkit-animation: ref-4120186d 1s linear infinite;
            animation: ref-4120186d 1s linear infinite
        }

        @-webkit-keyframes ref-4120186d {
            0% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg)
            }

            to {
                -webkit-transform: rotate(1turn);
                transform: rotate(1turn)
            }
        }

        @keyframes ref-4120186d {
            0% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg)
            }

            to {
                -webkit-transform: rotate(1turn);
                transform: rotate(1turn)
            }
        }

        .pop-main .btns {
            margin-top: 2px
        }


        .pop-main .btns {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            -ms-flex-align: center;
            align-items: center;
            -webkit-box-pack: center;
            -webkit-justify-content: center;
            -ms-flex-pack: center;
            justify-content: center
        }

        .pop-main .btn {
            cursor: pointer;
            background: #2464f6;
            line-height: 50px;
            width: 100%;
            margin: 10px 0 10px 0;
            font-size: 18px;
            font-weight: 700;
            color: #fff;
        }

        .pop-main .btns .btn.dis {
            opacity: .5
        }

        .pop-main .number-box {
            margin-bottom: 2px
        }

        .pop-main .number-box .number__title {
            font-size: 10px;
            color: #fff
        }

        .pop-main .number-box .number__items {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-pack: center;
            -webkit-justify-content: center;
            -ms-flex-pack: center;
            justify-content: center;
            padding-top: 18px;
            gap: 2px
        }

        .pop-main .number-box .number__items .verification-input {
            width: 100%;
            height: 30px;
            text-align: center;
            font-size: 18px;
            font-weight: 700;
            border: 6px solid #ebebeb;
            background: #fff;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .pop-main .number-box .number__items .verification-input:focus .verification-input:focus {
            outline: none;
            box-shadow: 0 0 .025rem #007bff
        }

        .pop-main .tip {
            font-size: 2px;
            text-align: center;
            color: #fff;
            margin-bottom: 2px
        }

        .pop-main .btn-submit {
            background: #2464f6;
            line-height: 50px;
            width: 100%;
            margin: auto;
            font-size: 18px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 20px;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        /* --- YANGI: Modal styling --- */
        #pop {
            display: none;
            /* default hidden */
            position: fixed;
            inset: 0;
            z-index: 10000;
        }

        #pop.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #pop .shadow {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.801);
        }

        #pop .dialog-main {
            position: relative;
            z-index: 1;
            background: transparent;
            max-height: 85vh;
            overflow-y: auto;
        }

        #pop .btn-close {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 50%;
            z-index: 2;
        }

        #pop .btn-close:hover {
            background: rgba(0, 0, 0, 0.5);
        }

        #pop .btn-close svg {
            width: 24px;
            height: 24px;
            fill: white;
        }



        .pop-main .upsubmit .youtubetext p {
            font-size: 14px;
            text-align: left;
        }

        .pop-main .upsubmit .dflex span {
            font-size: 14px;
        }

        .material-icons-outlined {
            color: #888888;
        }
        .lukcys {
            align-items: center;
        }
    </style>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    <title>Document</title>
</head>

<body>
    <img src="/image/bg-lucky-code.jpg" alt="" style=" margin-top: 50px;">
    <div>
        <div class="lukcys">
            <img src="/image/lukcy.png" alt="">
            <h3>Lucky Code</h3>
            <p>Find the lucky code in the video to get rewards</p>
        </div>
        <div id="key1">
            <div class="shaffof">
                <a href="https://youtu.be/HmaQwuKUYTc?si=blIzy-4IF_kIP7dO"></a>
                <div class="youtubepaf">
                    <i class="fa-brands fa-youtube"></i>
                </div>
                <div class="youtubetext">
                    <p>The Curve That Controls Your Coins?! Learn in Bonding Curve</p>
                    <div class="dflex">
                        <span>300,000</span>
                        <img class="key" src="/image/key.png" alt=""> 1
                    </div>
                </div>
                <span class="material-icons-outlined">arrow_forward_ios</span>
            </div>
        </div>
        <div id="key2">
            <div class="shaffof">
                <a href="https://youtu.be/b_8fHNIHFk4?si=D05wCEy9MPqUwG_V"></a>
                <div class="youtubepaf">
                    <i class="fa-brands fa-youtube"></i>
                </div>
                <div class="youtubetext">
                    <p>wwThe Curve That Controls Your Coins?! Learn in Bonding Curve</p>
                    <div class="dflex">
                        <span>300,000</span>
                        <img class="key" src="/image/key.png" alt=""> 1
                    </div>
                </div>
                <span class="material-icons-outlined">arrow_forward_ios</span>
            </div>
        </div>
    </div>


    <div id="pop">
        <div class="pop-dialog" show="true">
            <div class="shadow"></div>
            <div class="dialog-main center" style="width: 95%; height: auto;">
                <div class="btn-close">
                    <span class="material-icons-outlined">close</span>
                </div>
                <div class="pop-main">
                    <div class="energy__title"> Watch the video to get rewards
                    </div>
                    <div class="number-box">
                        <div class="number__title">Watch the video, find the Lucky
                            Code and pasteit here</div>
                        <div class="number__items">
                            <input class="verification-input">
                        </div>
                    </div><!---->
                    <div class="btn-submit dis"> Submit </div>
                    <div class="upsubmit"></div>
                    <div class="btns">
                        <div class="btn">Watch</div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    </div>
    <script>
        // show Telegram BackButton and set it to return to main renderGame
        showTelegramBack(() => { showNav(); renderGame(); });
        // hide bottom nav and enable Telegram Back to return to game
        hideNav();
        showTelegramBack(() => { hideTelegramBack(); showNav(); renderGame(); });

        // back handler
        document.getElementById('dailyBack').addEventListener('click', () => { hideTelegramBack(); showNav(); renderGame(); });

        // --- Telegram BackButton boshqaruv funksiyalari ---
        function showTelegramBack(handler) {
            if (window.Telegram?.WebApp?.BackButton) {
                try {
                    window.Telegram.WebApp.BackButton.show();
                    window.Telegram.WebApp.BackButton.onClick(handler);
                } catch (e) { /* ignore */ }
            }
        }

        function hideTelegramBack() {
            if (window.Telegram?.WebApp?.BackButton) {
                try {
                    window.Telegram.WebApp.BackButton.hide();
                    // handlerni bekor qilamiz
                    window.Telegram.WebApp.BackButton.onClick(() => { });
                } catch (e) { /* ignore */ }
            }
        }
        // helpers to hide/show bottom nav
        function hideNav() { const nav = document.querySelector('.nav'); if (nav) nav.style.display = 'none'; }
        function showNav() { const nav = document.querySelector('.nav'); if (nav) nav.style.display = ''; }
    </script>
    <script>
        (() => {
            
        
        const popModal = document.getElementById('pop');
        console.log('popModal:', popModal);
        const upsubmitDiv = popModal.querySelector('.upsubmit');
        console.log('upsubmitDiv:', upsubmitDiv);
        const watchBtn = popModal.querySelector('.pop-main .btns .btn');
        console.log('btnClose:', watchBtn);
        
        const btnClose = popModal.querySelector('.btn-close');
        console.log('btnClose:', btnClose);
        const shadow = popModal.querySelector('.shadow');
        console.log('shadow:', shadow);
        
        /* ===============================
           FUNKSIYA: Modal oynasidagi .shaffof uchun event listener bind qilish
        ================================ */
        function bindShaffofClickListener() {
            // eski listenerlarni olib tashlash uchun - event delegation orqali modal kontentida
            // Modal ichidagi shaffofga click bo'lsa linkni ochish
            const modal = document.getElementById('pop');
            
            console.log('bindShaffofClickListener - modal:', modal);
            // eski listener mavjud bo'lsa olib tashla
            modal.removeEventListener('click', handleShaffofClick);
            
            // yangi listener qo'sh
            modal.addEventListener('click', handleShaffofClick);
        }
        
        function handleShaffofClick(e) {
            const shaffof = e.target.closest('.upsubmit .shaffof');
            console.log('handleShaffofClick - shaffof:', shaffof);
            if (!shaffof) return;

            const link = shaffof.querySelector('a');
                console.log('link:', link);
            if (link?.href) {
                window.open(link.href, '_blank');
            }
        }

        /* ===============================
           1️⃣ KEY BOSILISHI (DELEGATION)
        ================================ */
        document.addEventListener('click', function (e) {
            const keyDiv = e.target.closest('[id^="key"]');
            console.log('keyDiv:', keyDiv);
            
            if (!keyDiv) return;

            const shaffofContent = keyDiv.querySelector('.shaffof');
            console.log('shaffofContent:', shaffofContent);
            
            if (!shaffofContent) return;

            const cloned = shaffofContent.cloneNode(true);
            console.log('cloned:', cloned);
            
            upsubmitDiv.innerHTML = '';
            upsubmitDiv.appendChild(cloned);

            const videoLink = cloned.querySelector('a');
            if (videoLink?.href) {
                watchBtn.dataset.videoUrl = videoLink.href;
            }

            popModal.classList.add('show');
            
            // Modal ochilganidan keyin .shaffof listener bind qilish
            bindShaffofClickListener();
        });

        /* ===============================
           3️⃣ WATCH TUGMASI
        ================================ */
        watchBtn.onclick = function () {
            const url = this.dataset.videoUrl;
            if (url) window.open(url, '_blank');
        };

        /* ===============================
           4️⃣ MODAL YOPISH
        ================================ */
        btnClose.onclick = () => popModal.classList.remove('show');
        shadow.onclick = () => popModal.classList.remove('show');

        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                popModal.classList.remove('show');
            }
        });
        })();
    </script>
</body>

</html>